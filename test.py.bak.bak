import json
import requests

jsondata={
	'prompt':'once upon a time ',
	'n_predict':25,
	'stream':True,
}

headers={"Content-type": "application/json"}

strdata=json.dumps(jsondata)

url='http://192.168.68.107:8080/v1'
url='http://192.168.68.107:8080/v1/chat/completions'
url='http://192.168.68.107:8080/completion'

#response=requests.post(url, data=strdata, headers=headers)
response=requests.post(url, data=strdata, headers=headers, stream=True)

#contentBytes=response.content
#contentDict=json.loads(contentBytes)
#content=contentDict['content']

result=''

for line in response.iter_lines():
	if line:
		#x=json.loads(line.decode('ascii'))
		x=json.loads(line[6:])
		content=x['content']
		print(content,end='',flush=True)
		result+=content
		#print(line.decode('ascii'))

print()
print(result)
